import{j as e,b as p,I as S,T as g,D as ne,$ as R,d as B,e as U,f as L,h as P,i as q,k as Q,l as H,q as K,S as I,u as ie,r as m,m as re,N as x,n as oe,o as le,M as j,L as ce,p as de,s as fe,A as Z,t as G,v as ue,w as _,x as he,y as W,z as me,C as O,E as ge,F as xe,H as pe,J as be,O as je}from"./index-BJrYkkbA.js";import{T as ve}from"./tag-B4RmpwG4.js";import{u as y}from"./useQuery-DFVQRQYW.js";import{u as Y}from"./use-breakpoint-BDq3u2OF.js";import{S as ye}from"./side-panel-provider-DxsBlxMi.js";import{u as we,a as V}from"./use-side-panel-29PCeUs6.js";import{I as Ne}from"./id-CWkxw1na.js";import{E as Ce}from"./empty-list-C7hzuEv3.js";import{u as Le}from"./use-api-DlchQti7.js";import"./useBaseQuery-CDY4cYzC.js";function He(t){const s=t.split(" ");return s.length===0?"":s.length===1?s[0].substring(0,2).toUpperCase():s[0].charAt(0).toUpperCase()+s[1].charAt(0).toUpperCase()}function k({icon:t,text:s,url:a,isLoading:n,isOffline:o,className:c}){return e.jsxs("div",{className:p("relative size-8 shrink-0 lg:size-9",c),children:[e.jsx("div",{className:"bg-accent inline-flex h-full w-full shrink-0 flex-col items-center justify-center overflow-hidden rounded-full align-top",children:n?e.jsx("div",{className:"bg-accent-secondary h-full w-full animate-pulse"}):t?e.jsx(S,{type:t,size:"lg",className:"text-on-brand"}):e.jsx(g,{as:"div",size:"sm",weight:"medium",className:"text-on-brand",children:a?e.jsx("img",{src:a,alt:s,className:"h-full w-full object-cover"}):s?He(s):e.jsx("img",{alt:"Nestor Doe",src:ne,className:"mr-0.5 mt-4 max-w-12"})})}),o!==void 0&&e.jsx("div",{className:p("border-1 border-background-primary absolute -bottom-0.5 -right-0.5 size-3 rounded-full",n?"bg-warning":o?"bg-error":"bg-success")})]})}function ke(){return e.jsxs(g,{as:"div",size:"sm",className:"bg-accent-tertiary text-accent grid grid-cols-[auto_1fr] gap-x-2 rounded-md px-2 py-1",children:[e.jsx("div",{className:"row-start-1 flex items-center",children:e.jsx(S,{type:"info-circle",size:"sm"})}),e.jsx("p",{className:"row-start-1",children:e.jsx("strong",{children:"Demo Mode"})}),e.jsx(g,{size:"xs",className:"text-secondary col-start-2 row-start-2",children:"You're signed in as a demo user."})]})}function Se({open:t,setOpen:s,title:a,children:n}){return e.jsx(R,{isDismissable:!0,isOpen:t,onOpenChange:s,className:"text-primary fixed inset-0 z-50 bg-black/50 data-[entering]:animate-[modal-blur_300ms] data-[exiting]:animate-[modal-blur_300ms_reverse_ease-in]",children:e.jsx(B,{className:"bg-primary fixed inset-y-0 right-0 w-full max-w-2xl overflow-y-scroll p-4 shadow-lg data-[entering]:animate-[modal-slide_300ms] data-[exiting]:animate-[modal-slide_300ms_reverse_ease-in]",children:e.jsxs(U,{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between gap-4",children:[e.jsx(g,{variant:"heading",size:"md",slot:"title",children:a}),e.jsx(L,{icon:"close",slot:"close",variant:"tertiary"})]}),n]})})})}function Ie({text:t,color:s="accent",underline:a="always",children:n}){return e.jsx(P,{label:t,offset:2,maxWidth:400,children:e.jsx(q,{className:p("cursor-help decoration-dashed decoration-1 underline-offset-2 hover:underline",s==="accent"&&"text-accent hover:text-accent-hover",s==="inherit"&&"hover:opacity-80",a==="always"&&"underline"),children:n})})}const Me="/assets/plakar-illustration-hello-CUlCX5j7.svg";function X({href:t,onClick:s}){const a=!t;return e.jsxs("div",{className:"bg-accent grid grid-cols-[1fr_auto] items-center rounded-sm",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsxs("div",{className:"flex flex-col justify-center gap-0.5 py-2 pl-3",children:[e.jsxs(g,{className:"text-on-brand",weight:"medium",size:"sm",children:[a?"Sign in":e.jsx(Q,{href:t,onPress:s,className:"hover:text-on-brand/80 underline",children:"Sign in"})," ","to get access to all features"]}),e.jsx(g,{className:"text-on-brand",size:"xs",children:"Magic link or GitHub"})]}),e.jsx("div",{className:"self-end",children:e.jsx("img",{alt:"plakar.io",src:Me,className:"h-[70px] w-[90px]"})})]}),a&&e.jsx(H,{leftIcon:"right-to-bracket",variant:"accent-tertiary",className:"mr-2 sm:mr-6",onClick:s,slot:"close",children:"Sign in"})]})}const ze="data:image/svg+xml,%3csvg%20width='71'%20height='14'%20viewBox='0%200%2071%2014'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M0%2013.2324V0.767555H5.38035C8.14965%200.767555%2010.006%202.52043%2010.006%205.17409C10.006%207.85818%208.10096%209.53193%205.25863%209.53193H3.38402V13.2324H0ZM3.38402%206.90262H4.57695C5.76379%206.90262%206.4759%206.2392%206.4759%205.17409C6.4759%204.10289%205.76379%203.4699%204.57695%203.4699H3.38402V6.90262Z'%20fill='white'/%3e%3cpath%20d='M11.2476%2013.2324V0.767555H14.6316V10.5058H19.6712V13.2324H11.2476Z'%20fill='white'/%3e%3cpath%20d='M24.277%2013.2324H20.6252L24.7396%200.767555H29.3652L33.4796%2013.2324H29.8278L29.1096%2010.8466H24.9952L24.277%2013.2324ZM25.7621%208.31466H28.3427L27.1011%204.20027H27.0037L25.7621%208.31466Z'%20fill='white'/%3e%3cpath%20d='M34.6801%2013.2324V0.767555H38.0642V5.80707H38.2346L41.9838%200.767555H45.9278L41.716%206.31833L46.0251%2013.2324H41.9838L39.1841%208.55811L38.0642%2010.0188V13.2324H34.6801Z'%20fill='white'/%3e%3cpath%20d='M50.17%2013.2324H46.5181L50.6325%200.767555H55.2582L59.3726%2013.2324H55.7207L55.0025%2010.8466H50.8882L50.17%2013.2324ZM51.655%208.31466H54.2357L52.994%204.20027H52.8967L51.655%208.31466Z'%20fill='white'/%3e%3cpath%20d='M60.5731%2013.2324V0.767555H65.9535C68.7227%200.767555%2070.5791%202.35001%2070.5791%205.00367C70.5791%206.7322%2069.7879%207.94339%2068.461%208.58246L70.993%2013.2324H67.3168L65.1257%209.11806H63.9571V13.2324H60.5731ZM63.9571%206.48875H65.1501C66.3369%206.48875%2067.049%206.06879%2067.049%205.00367C67.049%203.93247%2066.3369%203.4699%2065.1501%203.4699H63.9571V6.48875Z'%20fill='white'/%3e%3c/svg%3e",Ae="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='24'%20height='24'%20rx='12'%20fill='%230F172A'/%3e%3cpath%20d='M17.4287%209.9511C17.1909%209.19212%2016.801%208.50159%2016.2956%207.91434C16.6544%207.64774%2016.8869%207.21841%2016.8869%206.73504C16.8869%205.92562%2016.2354%205.26992%2015.4325%205.26992C14.7744%205.26992%2014.2189%205.71005%2014.0395%206.31352C13.3975%206.06252%2012.7001%205.92502%2011.9705%205.92502C11.3131%205.92502%2010.6812%206.0373%2010.0929%206.24266C9.89205%205.67583%209.35441%205.26992%208.72258%205.26992C7.91908%205.26992%207.26818%205.92622%207.26818%206.73504C7.26818%207.16077%207.44819%207.54386%207.73609%207.81167C7.18652%208.41993%206.76451%209.14709%206.51237%209.9505V9.95171C4.35701%2010.2015%202.68326%2012.0455%202.68326%2014.2834C2.68326%2016.6919%204.62166%2018.6446%207.01247%2018.6446C8.08181%2018.6446%209.05995%2018.2531%209.81516%2017.6058L13.3385%2017.613L14.1235%2017.6082C14.8787%2018.2543%2015.8557%2018.6446%2016.9238%2018.6446C19.3146%2018.6446%2021.253%2016.6919%2021.253%2014.2834C21.253%2012.0467%2019.5817%2010.2033%2017.4287%209.9511ZM11.9693%206.85933C12.3723%206.85933%2012.7633%206.91218%2013.137%207.01666L12.4194%209.84783C12.3979%209.93309%2012.3288%209.99134%2012.2489%209.99013C12.0933%209.98773%2011.8388%209.98833%2011.6832%209.99074C11.6034%209.99194%2011.5342%209.93369%2011.5122%209.84843L10.7993%207.01846C11.1748%206.91278%2011.5658%206.85933%2011.9687%206.85933H11.9693ZM12.7281%2012.0053L12.2596%2012.4232C12.0933%2012.5715%2011.8424%2012.5715%2011.6761%2012.4232L11.2076%2012.0053C10.9042%2011.7345%2011.0943%2011.2301%2011.4996%2011.2301H12.4367C12.842%2011.2301%2013.0315%2011.7351%2012.7287%2012.0053H12.7281ZM10.0184%209.70672C10.3486%209.70672%2010.6163%2010.0718%2010.6163%2010.5227C10.6163%2010.9737%2010.3486%2011.3388%2010.0184%2011.3388C9.6882%2011.3388%209.42057%2010.9737%209.42057%2010.5227C9.42057%2010.0718%209.6882%209.70672%2010.0184%209.70672ZM14.2225%2015.0076C14.4239%2015.2135%2014.4221%2015.545%2014.2177%2015.7479C14.1164%2015.8488%2013.9846%2015.8987%2013.8523%2015.8987C13.72%2015.8987%2013.5841%2015.8464%2013.4821%2015.7425C13.2074%2015.4621%2013.019%2015.0712%2012.9362%2014.6281C12.5922%2014.7013%2012.2411%2014.7386%2011.8901%2014.7386C11.5896%2014.7386%2011.2892%2014.7116%2010.9936%2014.6575C10.9083%2015.088%2010.7218%2015.4681%2010.4535%2015.7425C10.3516%2015.8464%2010.2175%2015.8987%2010.0834%2015.8987C9.94928%2015.8987%209.81934%2015.8482%209.718%2015.7479C9.51355%2015.545%209.51117%2015.2129%209.71324%2015.0076C9.8551%2014.8629%2010.0065%2014.5524%2010.0065%2014.1153C10.0065%2013.7454%209.88669%2013.3905%209.70191%2013.2122C9.49448%2013.0123%209.48792%2012.6808%209.68641%2012.4718C9.8849%2012.2629%2010.2145%2012.2563%2010.4214%2012.4562C10.7063%2012.7312%2010.9072%2013.1359%2010.9954%2013.5905C11.6147%2013.7334%2012.2674%2013.7256%2012.8831%2013.5665L12.9469%2013.5503C13.0393%2013.1119%2013.236%2012.7234%2013.5125%2012.4562C13.72%2012.2563%2014.049%2012.2629%2014.2475%2012.4718C14.446%2012.6808%2014.4394%2013.0123%2014.232%2013.2122C14.0466%2013.3911%2013.9274%2013.7454%2013.9274%2014.1153C13.9274%2014.5524%2014.0788%2014.8629%2014.2213%2015.0076H14.2225ZM13.9179%2011.3382C13.5876%2011.3382%2013.32%2010.9731%2013.32%2010.5221C13.32%2010.0712%2013.5876%209.70612%2013.9179%209.70612C14.2481%209.70612%2014.5157%2010.0712%2014.5157%2010.5221C14.5157%2010.9731%2014.2481%2011.3382%2013.9179%2011.3382Z'%20fill='white'/%3e%3c/svg%3e",$e="data:image/svg+xml,%3csvg%20width='72'%20height='14'%20viewBox='0%200%2072%2014'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M0.818226%2013.2324V0.767502H6.19858C8.96788%200.767502%2010.8242%202.52038%2010.8242%205.17404C10.8242%207.85813%208.91919%209.53188%206.07685%209.53188H4.20225V13.2324H0.818226ZM4.20225%206.90257H5.39518C6.58202%206.90257%207.29413%206.23915%207.29413%205.17404C7.29413%204.10283%206.58202%203.46985%205.39518%203.46985H4.20225V6.90257Z'%20fill='%230F172A'/%3e%3cpath%20d='M12.0658%2013.2324V0.767502H15.4499V10.5057H20.4894V13.2324H12.0658Z'%20fill='%230F172A'/%3e%3cpath%20d='M25.0952%2013.2324H21.4434L25.5578%200.767502H30.1835L34.2978%2013.2324H30.646L29.9278%2010.8465H25.8134L25.0952%2013.2324ZM26.5803%208.3146H29.1609L27.9193%204.20022H27.8219L26.5803%208.3146Z'%20fill='%230F172A'/%3e%3cpath%20d='M35.4984%2013.2324V0.767502H38.8824V5.80702H39.0528L42.802%200.767502H46.746L42.5342%206.31827L46.8434%2013.2324H42.802L40.0023%208.55806L38.8824%2010.0188V13.2324H35.4984Z'%20fill='%230F172A'/%3e%3cpath%20d='M50.9882%2013.2324H47.3364L51.4508%200.767502H56.0764L60.1908%2013.2324H56.539L55.8208%2010.8465H51.7064L50.9882%2013.2324ZM52.4733%208.3146H55.0539L53.8123%204.20022H53.7149L52.4733%208.3146Z'%20fill='%230F172A'/%3e%3cpath%20d='M61.3913%2013.2324V0.767502H66.7717C69.541%200.767502%2071.3973%202.34996%2071.3973%205.00362C71.3973%206.73215%2070.6061%207.94334%2069.2793%208.58241L71.8112%2013.2324H68.135L65.9439%209.11801H64.7753V13.2324H61.3913ZM64.7753%206.48869H65.9683C67.1551%206.48869%2067.8672%206.06873%2067.8672%205.00362C67.8672%203.93242%2067.1551%203.46985%2065.9683%203.46985H64.7753V6.48869Z'%20fill='%230F172A'/%3e%3c/svg%3e";function J({variant:t="full",isDemo:s}){return e.jsxs("div",{className:"relative inline-flex items-center gap-1 align-top",children:[e.jsx("img",{alt:"plakar.io",src:Ae,className:"w-6 shrink-0"}),t==="full"&&e.jsxs(e.Fragment,{children:[e.jsx("img",{alt:"plakar.io",src:$e,className:"dark:hidden"}),e.jsx("img",{alt:"plakar.io",src:ze,className:"hidden dark:block"})]}),s&&e.jsx(ve,{size:"sm",radius:"sqrt",variant:"brand",children:"Demo"})]})}const Pe=t=>K({queryKey:["api","discord","server_stats",t],queryFn:async()=>{const n=(await(await fetch(`https://discord.com/api/invites/${t}`)).json())?.profile?.member_count;if(n===void 0)throw new Error("Invalid response from Discord API");return n},refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1});function _e({invite:t,variant:s="default"}){const{data:a,isPending:n,isSuccess:o}=y(Pe(t));return e.jsxs("a",{target:"_blank",href:`https://discord.gg/${t}`,className:p("flex min-w-[60px] gap-1 rounded-sm border px-2 py-1",s==="default"?"border-primary bg-secondary text-secondary hover:bg-secondary-hover":"border-text-on-brand/50 text-on-brand"),children:[e.jsx(S,{type:"discord",size:"md",className:"shrink-0"}),n&&e.jsx(I,{variant:"text",size:"xs",width:"100%"}),o&&e.jsx(g,{variant:"body",size:"xs",monospace:!0,children:a})]})}const Ve=t=>K({queryKey:["api","github","repo_stars",t],queryFn:async()=>{const a=await(await fetch(`https://api.github.com/repos/${t}`)).json();if(a.stargazers_count===void 0)throw new Error("Invalid response from GitHub API");return a.stargazers_count},refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1});function De({repo:t,variant:s="default"}){const{data:a,isPending:n,isSuccess:o}=y(Ve(t));return e.jsxs("a",{target:"_blank",href:`https://github.com/${t}`,className:p("flex min-w-[60px] gap-1 rounded-sm border px-2 py-1",s==="default"?"border-primary bg-secondary text-secondary hover:bg-secondary-hover":"border-text-on-brand/50 text-on-brand"),children:[e.jsx(S,{type:"github",size:"md",className:"shrink-0"}),n&&e.jsx(I,{variant:"text",size:"xs",width:"100%"}),o&&e.jsx(g,{variant:"body",size:"xs",monospace:!0,children:a})]})}function T(t){const s=t.match(/^(v?[^-]+)-(.*)\.([a-f0-9]{7,})$/);return s?{Value:t,Pretty:`${s[1]}-${s[2]}.${s[3].substring(0,7)}`,Channel:`${s[1]}-${s[2]}`}:{Value:t,Pretty:t,Channel:t}}function Ze({value:t,channel:s=!1}){const a=s?T(t).Channel:T(t).Pretty,n=e.jsx(g,{as:o=>e.jsx("button",{...o}),variant:"body",size:"xs",className:"text-tertiary",children:a});return a!==t?e.jsx(P,{label:t,children:n}):n}function Oe(t){const s=ie();return t.find(o=>s({to:o,fuzzy:!0,pending:!0}))??t.find(o=>s({to:o,fuzzy:!0}))}const ee=()=>{const t=m.useContext(re);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t};function te({navItems:t,subNavItems:s,isExpanded:a,version:n,isFloating:o,canExpand:c,isDemo:l,user:i,controls:r,footer:f,handleToggle:d,onCloseMenu:u}){const{mode:b,toggleMode:M}=ee(),z=a?"full":"icon",A=a&&!o?"chevrons-left":"chevrons-right",se=s.find(h=>h.label==="Logout"),w=s.find(h=>h.label==="Login"),$=s.find(h=>h.label==="Settings");return e.jsxs("div",{className:"flex min-h-full flex-col justify-between gap-4 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"ml-2 flex items-baseline justify-between",children:[e.jsx(Q,{href:t[0].href,children:e.jsx(J,{variant:z,isDemo:l&&a})}),a&&e.jsx(Ze,{value:n,channel:l})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("span",{className:"flex min-w-0 items-center justify-between gap-2",children:[e.jsxs("span",{className:"flex min-w-0 items-center gap-2",children:[e.jsx("div",{className:"flex w-[39px] justify-center",children:i.isAuthenticated?e.jsx(k,{text:i.name||"",url:i.avatarUrl,isLoading:i.isPending,isOffline:!1}):e.jsx(k,{icon:"incognito",isLoading:i.isPending,isOffline:!0})}),a&&(i.isPending?e.jsx(I,{variant:"text",size:"sm",width:135}):e.jsx(g,{className:"text-tertiary truncate",size:"sm",weight:"medium",children:i.isAuthenticated?i.name||"You are logged in":"Guest"}))]}),a&&e.jsxs("span",{className:"flex items-center gap-2",children:[!i.isAuthenticated&&!i.isPending&&e.jsx(L,{icon:"right-to-bracket",size:"sm",variant:"tertiary",tooltip:"Sign in",href:w?.href}),r]})]}),e.jsx(x,{"aria-label":"main navigation",children:t.map(({subItems:h,...N},D)=>h&&h.length>0?e.jsx(x.Disclosure,{...N,isSelected:h.some(C=>C.isSelected)&&!a,defaultExpanded:!0,children:a&&h.map((C,ae)=>e.jsx(x.Item,{...C,onAction:u},`${C.label}${ae}`))},`${N.label}${D}`):e.jsx(x.Item,{...N,onAction:u},`${N.label}${D}`))})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[a&&!i.isPending&&e.jsxs(e.Fragment,{children:[l&&i.isAuthenticated&&e.jsx(ke,{}),!l&&!i.isAuthenticated&&e.jsx(X,{href:w?.href,onClick:u})]}),f&&m.cloneElement(f,{forceClose:!a}),e.jsxs("div",{className:"border-primary flex flex-col gap-8 border-t pt-4",children:[e.jsxs(x,{"aria-label":"settings navigation",children:[e.jsx(x.Item,{"aria-label":"Toggle theme",icon:b.icon,label:b.label,onAction:M,className:"cursor-pointer"}),$&&e.jsx(x.Item,{icon:"gear",label:"Settings",href:$?.href,onAction:u,isSelected:$?.isSelected,isDisabled:!i.isAuthenticated}),i.isAuthenticated?e.jsx(x.Item,{icon:"right-to-bracket",label:"Sign out",href:se?.href,onAction:u,isDisabled:l}):e.jsx(x.Item,{icon:"right-to-bracket",label:"Sign in",href:w?.href,onAction:u,isSelected:w?.isSelected})]}),e.jsxs("div",{className:"flex h-[26px] justify-between gap-2",children:[a&&e.jsxs("div",{className:"flex w-full items-center justify-center gap-2 lg:justify-start",children:[e.jsx(_e,{invite:"uuegtnF2Q5"}),e.jsx(De,{repo:"PlakarKorp/plakar"})]}),d&&e.jsx(L,{"aria-label":"Toggle sidebar",icon:A,size:"sm",variant:"tertiary",onPress:d,tooltip:"Toggle sidebar",isDisabled:!c,className:p(!a&&"w-full text-center")})]})]})]})]})}function Te({subNavItems:t,user:s,isDemo:a=!1}){const{mode:n,toggleMode:o}=ee(),c=t.find(r=>r.label==="Logout"),l=t.find(r=>r.label==="Login"),i=t.find(r=>r.label==="Settings");return e.jsxs(oe,{children:[e.jsx(q,{"aria-label":"Profile",className:"cursor-pointer",children:s.isAuthenticated?e.jsx(k,{text:s.name||"",url:s.avatarUrl,isLoading:s.isPending,isOffline:!1}):e.jsx(k,{icon:"incognito",isOffline:!0})}),!s.isPending&&e.jsx(le,{placement:"bottom end",offset:4,children:e.jsxs(j,{children:[e.jsx(j.Item,{leftIcon:n.icon,label:n.label,onAction:o,className:"cursor-pointer"}),s.isAuthenticated?e.jsxs(e.Fragment,{children:[i&&e.jsx(j.Item,{leftIcon:"gear",label:"Settings",href:i.href}),e.jsx(j.Item,{leftIcon:"right-to-bracket",label:"Sign out",href:c?.href,isDisabled:a})]}):e.jsx(j.Item,{leftIcon:"right-to-bracket",label:"Sign in",href:l?.href})]})})]})}function Fe(t){const[s,a]=m.useState(!1),{navItems:n,subNavItems:o,user:c,isDemo:l}=t,i=n.flatMap(r=>r.subItems||r).find(r=>r.isSelected);return e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:"border-primary bg-primary flex items-center justify-between border-b p-2 pl-4 lg:hidden",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{to:"/",children:e.jsx(J,{variant:"icon"})}),e.jsx(H,{variant:"tertiary",leftIcon:"bars",size:"sm",onPress:()=>a(!0),children:i?.label})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(Te,{subNavItems:o,user:c,isDemo:l})})]}),e.jsx(R,{isOpen:s,onOpenChange:a,className:"fixed inset-0 bg-black/50 data-[entering]:animate-[modal-fade_150ms] data-[exiting]:animate-[modal-fade_reverse_150ms] xl:hidden",isDismissable:!0,children:e.jsx(B,{className:"bg-primary z-1 w-70 fixed left-0 h-full overflow-auto shadow-xl data-[entering]:animate-[modal-slide-right_200ms_ease-out] data-[exiting]:animate-[modal-slide-right_150ms_reverse_ease-in]",children:e.jsx(U,{"aria-label":"Navigation",className:"h-full overflow-y-auto p-4",children:e.jsx(te,{...t,isExpanded:!0,isFloating:!1,canExpand:!1,onCloseMenu:()=>a(!1)})})})})]})}function Ee(){const{position:t}=we(),{preview:s}=de({strict:!1}),{is3xlDown:a}=Y();return!!s&&t==="horizontal"&&a}function Re(t){const{isLgUp:s,isXlUp:a}=Y(),n=Ee(),[o,c]=m.useState(!0),[l,i]=m.useState(!1);if(!s)return e.jsx(Fe,{...t});const r=!n&&a,f=o&&r||l,d=l&&!(o&&r)||!s,u=!n,b=()=>{i(!0)},M=()=>{i(!1)},z=()=>{c(A=>!A),i(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("aside",{className:p("border-primary bg-primary z-1 absolute h-full overflow-y-auto border-r p-4",f?"w-70":"w-18",d&&"shadow-xl"),onMouseEnter:b,onMouseLeave:M,children:e.jsx(te,{...t,isExpanded:f,isFloating:d,canExpand:r,handleToggle:z})}),e.jsx("div",{className:p("h-full",f&&!d?"w-70":"w-18",u&&"transition-[width] duration-150 ease-out")})]})}function Be({children:t,...s}){return e.jsxs("div",{className:"flex h-full min-h-0 flex-col overflow-hidden lg:flex-row",children:[e.jsx(Re,{...s}),e.jsx("main",{className:"relative h-full min-h-0 flex-1",children:e.jsx("div",{className:"h-full overflow-auto",children:t})})]})}const F=[{label:"Dashboard",href:{to:"/"},icon:"house"},{label:"Snapshots",href:{to:"/snapshots"},icon:"box-archive"},{label:"Alerting",href:{to:"/alerting"},icon:"list-check"},{label:"Analytics",href:{to:"/analytics"},icon:"chart-pie"},{label:"Integrations",href:{to:"/integrations"},icon:"plug"}],E=[{label:"Login",href:{to:"/login"}},{label:"Logout",href:{to:"/logout"}},{label:"Settings",href:{to:"/settings"}}],v=()=>e.jsx(I,{variant:"text",size:"xs"});function Ue({repositoryInfo:t,isPending:s}){const a=t?.configuration,n=t?.location;return s?[{label:"ID",value:v()},{label:"Location",value:v()},{label:"Chunking",value:v()},{label:"Compression",value:v()},{label:"Encryption",value:v()}]:[{label:"ID",value:e.jsx(Ne,{value:a?.repository_id?.Value??"-",size:"xs",className:"h-4"})},{label:"Location",value:n?e.jsx(P,{label:n,children:e.jsx("span",{role:"button",children:n})}):"-"},{label:"Chunking",value:a?.chunking?.algorithm??"Chunking disabled",tooltip:"A chunking algorithm splits data into smaller pieces, or “chunks,” based on specific rules (e.g., fixed size or content-defined). This enables efficient deduplication by identifying and eliminating redundant data. Plakar currently uses FastCDC, a fast and content-aware chunking algorithm."},{label:"Compression",value:a?.compression?.algorithm??"Not compressed",tooltip:"A compression algorithm reduces the size of data by encoding patterns and redundancies, helping save storage space and speed up transfers. Different algorithms offer trade-offs between speed, compression ratio, and resource usage. Plakar currently uses LZ4, a high-speed compression algorithm optimized for fast storage and retrieval."},{label:"Encryption",value:a?.encryption?.data_algorithm??"Not encrypted",tooltip:"An encryption algorithm protects data by transforming it into an unreadable format, ensuring confidentiality and integrity. In encrypted repositories, the only way to access the data is with the correct passphrase — without it, the data remains completely inaccessible."}]}function qe({label:t,value:s,tooltip:a}){return e.jsx(G.Item,{title:a?e.jsx(Ie,{text:a,color:"inherit",children:t}):t,description:s})}function Qe({forceClose:t}){const{isPending:s,isError:a,data:n}=y(ue()),[o,c]=fe("kloset-desription-open",!0),l=Ue({repositoryInfo:n?.item,isPending:s});return a?null:e.jsx(Z,{defaultExpandedKeys:o?["kloset"]:[],expandedKeys:t||!o?[]:["kloset"],className:"border-primary overflow-hidden border-t pl-3 pr-2 pt-4",children:e.jsx(Z.Item,{id:"kloset",title:"Kloset store",icon:"database",onExpandedChange:()=>c(!o),children:e.jsx("div",{className:"pt-1",children:e.jsx(G,{direction:"row",size:"xs",singleColumn:!0,children:l.map(i=>e.jsx(qe,{label:i.label,value:i.value,tooltip:i.tooltip},i.label))})})})})}const Ke={unknown:"default",info:"default",warning:"warning",error:"error",critical:"error"},Ge={unknown:void 0,info:void 0,warning:"Warning",error:"Error",critical:"Critical Error"};function We({repository:t}){const s=V(_({repository:t})),a=he(),n=W();if(s.isPending)return e.jsx(me,{});if(s.isError)return e.jsx(Ce,{illustrationType:"sad",title:"Something went wrong while fetching notifications.",description:s.error.message});const o=s.data.pages[0],c=s.data.pages.flatMap(r=>r.notifications?.items).filter(r=>r!==void 0);if(o.__type==="unauthenticated")return e.jsx(X,{onClick:()=>a({to:"/login"})});if(c.length===0)return e.jsx("div",{className:"text-sm",children:"You have no unread notifications."});const l=c.some(r=>r.status==="unread"),i=()=>{n.mutate({notificationIds:c.filter(r=>r.status==="unread").map(r=>r.id),status:"read"})};return e.jsxs("div",{className:"flex flex-col gap-3",children:[l&&e.jsx("div",{className:"self-end",children:e.jsx(H,{leftIcon:"check",variant:"secondary",size:"sm",onPress:i,children:"Mark all as read"})}),e.jsx(O,{ariaLabel:"Notifications",children:c.map(r=>e.jsx(O.Item,{severity:Ke[r.level],title:Ge[r.level],description:r.message,date:r.created_at.relativeToNow(),unread:r.status==="unread"},r.id))}),s.hasNextPage&&e.jsx(H,{size:"sm",variant:"secondary",onPress:()=>s.fetchNextPage(),isDisabled:s.isFetchingNextPage,children:"Load more"})]})}function Ye({repository:t,open:s,setOpen:a}){return e.jsx(Se,{open:s,setOpen:a,title:"Notifications",children:e.jsx(We,{repository:t})})}function Xe({repository:t,onPress:s}){const a=V(_({repository:t,status:"unread"})),n=a.data?.pages[0].__type==="ok"?a.data.pages[0].notifications.total:void 0;return e.jsxs("span",{className:p(n!==void 0&&n>0&&"relative inline-block pr-2"),children:[e.jsx(L,{"aria-label":"Open notifications",variant:"tertiary",icon:(n!==void 0&&n>0,"bell"),onPress:s,size:"sm",tooltip:"Notifications"}),n!==void 0&&n>0&&e.jsx("span",{className:"px-0.75 pointer-events-none absolute -top-2 right-0 flex min-w-4 items-center justify-center rounded-full bg-red-500 text-xs font-medium text-white",children:n>99?"99+":n})]})}function Je(t){const s=m.useRef(!1),{data:a,isPending:n}=V(_({repository:t,status:"unread"})),{mutate:o}=W(),l=a?.pages.map(b=>b.notifications?.items).flat().filter(b=>b?.flags.isBanner).reverse()?.[0],i=l?.level??"unknown",r=l?.id,f=l?.message,d=l?.flags.isBanner,u={unknown:"default",info:"default",warning:"warning",error:"error",critical:"error"}[i];m.useEffect(()=>{s.current||n||!r||!d||(ge({content:{variant:u,title:i,buttonProps:{children:"Mark as read",variant:"secondary",slot:"close",onPress:()=>{o({notificationIds:[r],status:"read"})}},children:f,closable:!1},sticky:!0}),s.current=!0)},[n,u,r,i,f,d,o])}function et({repository:t,version:s,children:a}){const[n,o]=m.useState(!1);Le(),Je(t);const c=y(xe()),{data:{demo_mode:l}={}}=y(pe()),i=Oe([...F,...E].map(d=>String(d.href?.to))),r=m.useMemo(()=>F.map(d=>({...d,isSelected:i===d.href?.to})),[i]),f=m.useMemo(()=>E.map(d=>({...d,isSelected:i===d.href?.to})),[i]);return e.jsxs(ye,{children:[e.jsx(Be,{navItems:r,subNavItems:f,user:{name:c.data?.name,avatarUrl:c.data?.avatar_url,isPending:c.isPending,isAuthenticated:!!c.data},version:s,controls:e.jsx(Xe,{repository:t,onPress:()=>o(d=>!d)}),footer:e.jsx(Qe,{}),isDemo:l,children:a}),e.jsx(Ye,{open:n,setOpen:o,repository:t})]})}function ft(){const t=be.useLoaderData();return e.jsx(et,{repository:t.repository_id,version:t.version,children:e.jsx(je,{})})}export{ft as component};
