import{j as a,I as b,T as g,aO as p,v as f,aP as j,aQ as w,B as d}from"./index-Aj8lmPfQ.js";import{u as y}from"./useQuery-D2qmIidq.js";import{u as P}from"./useSuspenseQuery-DpMyaBMz.js";import{M as S}from"./main-Ds-kxHfS.js";import{b as C,a as I,M as N}from"./breadcrumbs-for-path-e4JWC8GD.js";import{c as v,u as M,g as R,P as Q}from"./paginated-table-DM9J9R9a.js";import"./useBaseQuery-CGDUSr1J.js";import"./Table-C77OlBPR.js";import"./empty-list-CA93N3UA.js";import"./pagination-Bv4QYb70.js";function E({query:s,page:r,perPage:i,onPageChange:c}){const o=v(),m=[o.accessor("name",{header:()=>"Filename",meta:{cellClassName:"min-w-80 md:min-w-none md:w-1/3"},cell:({row:e})=>a.jsxs("div",{className:"flex gap-2",children:[a.jsx(b,{type:"exclamation-circle",className:"text-error",size:"md"}),a.jsx(g,{weight:"medium",size:"md",className:"text-primary select-text break-all leading-none",children:e.original.name})]})}),o.accessor("error",{header:()=>"Error",meta:{cellClassName:"min-w-80 md:min-w-none"},cell:({row:e})=>a.jsx(g,{weight:"normal",className:"text-secondary select-text break-all",children:e.original.error})})],n={pageIndex:r,pageSize:i},l=M({data:s.data?.items??[],rowCount:s.data?.total,columns:m,state:{pagination:n},getRowId:(e,t)=>`row-${t}`,enableMultiRowSelection:!1,onPaginationChange:e=>{const t=typeof e=="function"?e(n):e;c(t.pageIndex,t.pageSize)},manualPagination:!0,getCoreRowModel:R()});return a.jsx(Q,{variant:"cards",query:s,table:l,ariaLabel:"Snapshot errors"})}function G(){const{snapshotId:s,source:r}=p.useParams(),{path:i,page:c,per_page:o}=p.useSearch(),m=p.useNavigate(),{api:n}=f(),l=y({...j(n,{repository:void 0,snapshot:s,source:r,path:i,pagination:{page:c,perPage:o}})}),e=P(w(n,{repository:void 0,snapshot:s})),t=(x,u)=>m({search:h=>({...h,page:h.per_page!==u?0:x,per_page:u})});return a.jsx(S,{title:a.jsx(N,{snapshot:e.data.item,source:r}),breadcrumb:a.jsx(d,{children:I(e.data.item.identifier,r,e.data.item.sources[r].importer.directory)}),children:a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs(d,{children:[C(e.data.item.identifier,r,e.data.item.sources[r].importer.directory,i),a.jsx(d.Crumb,{to:"/snapshots/$snapshotId/$source/errors",params:{snapshotId:s,source:r},children:"Errors"},"currentPath")]}),a.jsx(E,{query:l,page:c,perPage:o,onPageChange:t})]})})}export{G as component};
