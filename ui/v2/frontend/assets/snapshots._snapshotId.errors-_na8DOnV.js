import{j as a,I as b,T as g,aM as p,v as x,aN as f,aO as w,B as h}from"./index-CdIc90l8.js";import{u as y}from"./useQuery-BzyMkyU9.js";import{u as j}from"./useSuspenseQuery-D9MoHFrL.js";import{M as C}from"./icon-badge-CJfylEPM.js";import{c as P,u as S,g as N,P as I}from"./paginated-table-BobOAkaF.js";import{b as R}from"./breadcrumbs-for-path-oL70y6st.js";import"./useBaseQuery-Cr4gMxig.js";import"./Table-DqT_aCgx.js";import"./empty-list-DCGZXt7T.js";import"./pagination-DnzyOhfo.js";function v({query:r,page:o,perPage:n,onPageChange:t}){const i=P(),m=[i.accessor("name",{header:()=>"Filename",meta:{cellClassName:"min-w-80 md:min-w-none md:w-1/3"},cell:({row:e})=>a.jsxs("div",{className:"flex gap-2",children:[a.jsx(b,{type:"exclamation-circle",className:"text-error",size:"md"}),a.jsx(g,{weight:"medium",size:"md",className:"text-primary select-text break-all leading-none",children:e.original.name})]})}),i.accessor("error",{header:()=>"Error",meta:{cellClassName:"min-w-80 md:min-w-none"},cell:({row:e})=>a.jsx(g,{weight:"normal",className:"text-secondary select-text break-all",children:e.original.error})})],s={pageIndex:o,pageSize:n},l=S({data:r.data?.items??[],rowCount:r.data?.total,columns:m,state:{pagination:s},getRowId:(e,c)=>`row-${c}`,enableMultiRowSelection:!1,onPaginationChange:e=>{const c=typeof e=="function"?e(s):e;t(c.pageIndex,c.pageSize)},manualPagination:!0,getCoreRowModel:N()});return a.jsx(I,{variant:"cards",query:r,table:l,ariaLabel:"Snapshot errors"})}function H(){const{snapshotId:r}=p.useParams(),{path:o,page:n,per_page:t}=p.useSearch(),i=p.useNavigate(),{api:m}=x(),s=y({...f(m,{repository:void 0,snapshot:r,path:o,pagination:{page:n,perPage:t}})}),l=(c,u)=>i({search:d=>({...d,page:d.per_page!==u?0:c,per_page:u})}),e=s.data?s.data.total==1?"1 error":`${s.data.total} errors`:"Errors";return a.jsx(C,{title:e,breadcrumb:a.jsx(M,{snapshotId:r,path:o}),children:a.jsx(v,{query:s,page:n,perPage:t,onPageChange:l})})}function M({snapshotId:r,path:o}){const{api:n}=x(),t=j(w(n,{repository:void 0,snapshot:r})),i=R(t.data.item.identifier,t.data.item.sources[0].importer.directory,o);return a.jsxs(h,{children:[...i,a.jsx(h.Crumb,{to:"/snapshots/$snapshotId/errors",params:{snapshotId:r},children:"All errors"},"currentPath")]})}export{H as component};
